<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Ultra - Private Stream</title>
    <style>
        body { background: #0b0b0f; color: #e2e8f0; font-family: 'Inter', sans-serif; margin: 0; overflow-x: hidden; }
        .nav { padding: 20px; background: #16161e; border-bottom: 1px solid #23232f; text-align: center; }
        input { width: 85%; max-width: 500px; padding: 14px; border-radius: 12px; border: 1px solid #2d2d3d; background: #1a1a24; color: #fff; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: #7c3aed; box-shadow: 0 0 15px rgba(124, 58, 237, 0.3); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 20px; padding: 25px; }
        .card { background: #16161e; border-radius: 12px; overflow: hidden; border: 1px solid #23232f; cursor: pointer; transition: 0.3s; }
        .card:hover { transform: translateY(-8px); border-color: #7c3aed; }
        .card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
        .card p { font-size: 13px; padding: 12px; margin: 0; text-align: center; font-weight: 500; }
        #viewer { position: fixed; inset: 0; background: #000; display: none; flex-direction: column; z-index: 9999; }
        .v-shell { width: 100%; flex-grow: 1; display: flex; align-items: center; justify-content: center; background: #000; }
        iframe { width: 100%; height: 100%; border: none; }
        .btn-close { background: #ef4444; color: #fff; padding: 16px; border: none; font-weight: bold; cursor: pointer; font-size: 14px; }
        .server-list { display: flex; gap: 10px; padding: 15px; background: #16161e; overflow-x: auto; border-top: 1px solid #23232f; }
        .s-btn { background: #23232f; color: #fff; border: 1px solid #2d2d3d; padding: 10px 20px; border-radius: 8px; cursor: pointer; white-space: nowrap; }
        .s-btn.active { background: #7c3aed; border-color: #a78bfa; }
    </style>
</head>
<body>

<div class="nav">
    <input type="text" placeholder="Type Anime Name..." oninput="search(this.value)">
</div>

<div id="results" class="grid"></div>

<div id="viewer">
    <button class="btn-close" onclick="closeV()">âœ• EXIT PLAYER</button>
    <div class="v-shell" id="v-shell"></div>
    <div class="server-list" id="server-list"></div>
</div>

<script>
    let timer;
    let currentTitle = "";

    // These are the ONLY three servers working for free domains in 2026
    const SOURCES = [
        { name: "SuperStream (Fast)", url: "https://multiembed.mov/?video_id=" },
        { name: "Anime-Direct", url: "https://www.bread-sh.click/api/anime?title=" },
        { name: "Global Mirror", url: "https://vidsrc.xyz/embed/anime?title=" }
    ];

    async function search(q) {
        if (q.length < 3) return;
        clearTimeout(timer);
        timer = setTimeout(async () => {
            try {
                const res = await fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(q)}&limit=20`);
                const { data } = await res.json();
                document.getElementById('results').innerHTML = data.map(a => `
                    <div class="card" onclick="playA('${a.title.replace(/'/g, "")}')">
                        <img src="${a.images.webp.image_url}">
                        <p>${a.title}</p>
                    </div>
                `).join('');
            } catch (e) { console.log("Search lag..."); }
        }, 600);
    }

    function playA(title) {
        currentTitle = title;
        document.getElementById('viewer').style.display = 'flex';
        
        const list = document.getElementById('server-list');
        list.innerHTML = SOURCES.map((s, i) => `
            <button class="s-btn ${i===0?'active':''}" onclick="setS('${s.url}', this)">${s.name}</button>
        `).join('');
        
        setS(SOURCES[0].url);
    }

    function setS(base, btn) {
        if(btn) {
            document.querySelectorAll('.s-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
        const shell = document.getElementById('v-shell');
        // We use the ID/Title to trigger the direct multi-embed logic
        shell.innerHTML = `<iframe src="${base}${encodeURIComponent(currentTitle)}" allowfullscreen="true"></iframe>`;
    }

    function closeV() {
        document.getElementById('viewer').style.display = 'none';
        document.getElementById('v-shell').innerHTML = '';
    }
</script>
</body>
</html>
