<script>
    let timer;
    async function doSearch(q) {
        clearTimeout(timer);
        if (q.length < 3) return;
        timer = setTimeout(async () => {
            const status = document.getElementById('status');
            status.innerText = "ðŸ¤– Searching...";
            try {
                // Try your private bot first
                let res = await fetch(`/api/anime?q=${encodeURIComponent(q)}`);
                
                // EMERGENCY BYPASS: If your bot fails, talk to the provider directly
                if (!res.ok) {
                    console.log("Private bot down, bypassing...");
                    res = await fetch(`https://api.amvstr.me/api/search?q=${encodeURIComponent(q)}`);
                }

                const data = await res.json();
                status.innerText = "";
                
                // Format the results
                const results = data.results || data;
                
                document.getElementById('results').innerHTML = results.map(a => `
                    <div class="card" onclick="loadAnime('${a.id}')">
                        <img src="${a.image || a.poster || ''}">
                        <p>${a.title || a.name}</p>
                    </div>
                `).join('');
            } catch (e) { 
                status.innerText = "All sources busy. Please refresh."; 
            }
        }, 600);
    }
    // ... loadAnime and play functions stay the same ...
</script>
